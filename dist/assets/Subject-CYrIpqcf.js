import{av as D,aw as k,bo as j,ay as I,bp as T,b4 as h,b5 as c,az as x,aA as a,aB as r,aG as e,aF as v,aC as b,aD as p,F as S,aE as y,aH as d,am as u,b7 as m,bq as w,aI as N,aJ as V}from"./index-4Bm1Eb5i.js";const z={data(){return{appStore:k(),subjectStore:j(),itemsChoosen:[],subjects:j().subjects.map(o=>({...o,choosen:!1})),deleteDialogShow:!1,addDialogShow:!1,addSubjectId:void 0,addSubjectTitle:"",addSubjectType:"类别",addSubjectSuggGrade:"建议修读年级",addSubjectNote:void 0}},watch:{itemsChoosen:{deep:!0,handler(o,s){this.subjectStore.subjectsChoosen=this.itemsChoosen}}},name:"Subject",components:{NScrollbar:I,Dialog:T},mounted(){this.appStore.sideOn=!1,document.getElementById("rside").style.visibility="visible",this.queryAllSubjects()},methods:{queryAllSubjects(){h.get("/api/subject/queryall",{headers:{token:c().token,username:c().username}}).then(o=>{this.subjects=o.data.data})},chooseSubject(o,s){this.subjects=this.subjects.map(f=>({...f,choosen:!1})),this.subjects[s].choosen=!0,this.itemsChoosen=[o]},deleteSubject(){this.deleteDialogShow=!1,h.delete(`/api/subject/${this.itemsChoosen[0].id}`,{headers:{username:c().username,token:c().token}}).then(o=>{o.data.code===0?this.$toast.add({severity:"success",summary:"删除科目成功！删除的科目ID："+o.data.data,life:3e3}):this.$toast.add({severity:"success",summary:"删除科目失败！请自查原因或联系管理员",life:3e3})}).catch(o=>{this.$toast.add({severity:"success",summary:"删除科目错误！请自查原因或联系管理员",life:3e3})}),this.queryAllSubjects(),this.itemsChoosen=[]},addSubject(){if(this.addSubjectId===void 0||this.addSubjectTitle===""||this.addSubjectType==="类别"||this.addSubjectSuggGrade==="建议修读年级"){this.$toast.add({severity:"warn",summary:"有必填信息未填！",life:1500});return}h.put("/api/subject/index",{id:this.addSubjectId,title:this.addSubjectTitle,type:this.addSubjectType,sugsGrade:this.addSubjectSuggGrade,num:0,note:this.addSubjectNote},{headers:{username:c().username,token:c().token}}).then(o=>{console.log(o),o.data.code===0?(this.queryAllSubjects(),this.itemsChoosen=[],this.addDialogShow=!1,this.$toast.add({severity:"success",summary:"新增科目成功！科目ID："+this.addSubjectId,detail:"通知显示10s后自动隐藏",life:1e4})):this.$toast.add({severity:"error",summary:"新增科目失败！请自查原因或联系管理员",detail:"通知显示3s后自动隐藏",life:3e3})}).catch(o=>{this.$toast.add({severity:"error",summary:"新增科目错误！请自查原因或联系管理员",detail:"通知显示3s后自动隐藏",life:3e3})})},diffChoose(){this.subjects=this.subjects.map(o=>({...o,choosen:!o.choosen})),this.itemsChoosen=this.subjects.filter(o=>o.choosen)},allChoose(){this.subjects.every(o=>o.choosen)?(this.subjects=this.subjects.map(o=>({...o,choosen:!1})),this.itemsChoosen=[]):(this.subjects=this.subjects.map(o=>({...o,choosen:!0})),this.itemsChoosen=this.subjects.slice(0))},ubject(){}}},n=o=>(N("data-v-e8f370f4"),o=o(),V(),o),G={id:"subject",class:"flex flex-col items-center p-2"},U=n(()=>e("span",{class:"text-base mt-4 mb-4 pt-0.5 px-2 font-normal",style:{width:"300px","text-align":"left","vertical-align":"center"}}," TIP：点击科目可以选中并进行操作 ",-1)),q={class:"subject-prop-title flex gap-x-2 relative"},A=n(()=>e("span",null,"科目ID",-1)),B=n(()=>e("span",null,"科目名称",-1)),E=n(()=>e("span",null,"科目类别",-1)),F=n(()=>e("span",null,"建议修读年级",-1)),M=n(()=>e("span",null,"修读人数",-1)),H=n(()=>e("span",null,"备注",-1)),J={class:"flex gap-x-2 absolute right-0 bottom-[0.15rem]"},L=["onClick"],O={class:"subject-prop"},P={class:"subject-prop"},K={class:"subject-prop"},Q={class:"subject-prop"},R={class:"subject-prop"},W={class:"subject-prop"},X={key:0},Y=n(()=>e("div",{class:"text-lg mb-4"},"将要删除的科目：",-1)),Z={class:"text-base flex gap-x-2 bg-accent rounded-lg my-1.5 p-2"},$={class:"flex justify-between w-full mt-5"},ee={key:1},te=n(()=>e("div",{class:"text-lg mb-3"},"新增科目信息：",-1)),se={class:"add-dialog flex flex-wrap gap-y-2 gap-x-2"},oe={class:"flex justify-between items-center w-[16rem]"},ne=n(()=>e("span",null,"ID：",-1)),ie={class:"flex items-center justify-between w-[16rem]"},de=n(()=>e("span",null,"名称：",-1)),le={class:"flex justify-between w-[16rem]"},ae={class:"flex flex-col"},re=n(()=>e("span",{class:"mb-1"},"类别:",-1)),ce=n(()=>e("option",{style:{height:"35px!important"}},"文科类",-1)),ue=n(()=>e("option",{style:{height:"35px!important"}},"理科类",-1)),he=n(()=>e("option",{style:{height:"35px!important"}},"工科类",-1)),be=n(()=>e("option",{style:{height:"35px!important"}},"社科类",-1)),pe=n(()=>e("option",{style:{height:"35px!important"}},"医科类",-1)),me=[ce,ue,he,be,pe],fe={class:"flex flex-col"},ge=n(()=>e("span",{class:"mb-1"},"建议修读年级:",-1)),_e=n(()=>e("option",{selected:""},"7",-1)),je=n(()=>e("option",null,"8",-1)),xe=n(()=>e("option",null,"9",-1)),ve=n(()=>e("option",null,"10",-1)),Se=n(()=>e("option",null,"11",-1)),ye=n(()=>e("option",null,"12",-1)),we=[_e,je,xe,ve,Se,ye],Ce={class:"flex justify-between w-full mt-5"};function De(o,s,f,ke,i,l){const C=x("NScrollbar"),g=x("Dialog");return a(),r("div",G,[U,e("div",q,[A,B,E,F,M,H,e("div",J,[e("div",{class:"btn btn-ghost btn-sm hover:bg-secondary bg-[#f5f5f5]",onClick:s[0]||(s[0]=t=>i.addDialogShow=!0)},"新增"),e("div",{class:"btn btn-ghost btn-sm hover:bg-secondary bg-[#f5f5f5]",onClick:s[1]||(s[1]=t=>i.deleteDialogShow=!0)},"删除"),e("div",{class:v([{"all-choose":i.subjects.every(t=>t.choosen)},"btn btn-ghost btn-sm hover:bg-secondary bg-[#f5f5f5]"]),onClick:s[2]||(s[2]=(...t)=>l.allChoose&&l.allChoose(...t))},"全选 ",2)])]),b(C,{style:{padding:"0.8rem","max-height":"450px","min-height":"100px","min-width":"70vw",border:"1px #ccc solid","border-radius":"0.5rem","background-color":"#fff"}},{default:p(()=>[(a(!0),r(S,null,y(i.subjects,(t,_)=>(a(),r("div",{class:v([{"subject-choosen":t.choosen},"subject rounded-lg flex items-center gap-x-2 px-2 py-4 cursor-pointer bg-[#f5f5f5] hover:bg-secondary"]),onClick:Ie=>l.chooseSubject(t,_)},[e("div",O,d(t.id),1),e("div",P,d(t.title),1),e("div",K,d(t.type),1),e("div",Q,d(t.sugsGrade),1),e("div",R,d(t.num),1),e("div",W,d(t.note===void 0?"无":t.note),1)],10,L))),256))]),_:1}),b(g,{visible:i.deleteDialogShow,"onUpdate:visible":s[5]||(s[5]=t=>i.deleteDialogShow=t),style:{width:"20rem",padding:"0.5rem","border-radius":"1rem"},header:"删除科目",modal:""},{default:p(()=>[i.itemsChoosen.length>0?(a(),r("div",X,[Y,e("div",null,[(a(!0),r(S,null,y(i.itemsChoosen,(t,_)=>(a(),r("div",Z,[e("span",null,d(t.id),1),e("span",null,d(t.title),1)]))),256))]),e("div",$,[e("span",{class:"border-none btn btn-sm px-4 bg-[#f5f5f5] hover:bg-secondary",onClick:s[3]||(s[3]=t=>i.deleteDialogShow=!1)},"取消"),e("span",{class:"border-none btn btn-sm px-4 bg-[#f5f5f5] hover:bg-error hover:text-white",onClick:s[4]||(s[4]=(...t)=>l.deleteSubject&&l.deleteSubject(...t))},"确认删除")])])):(a(),r("div",ee,"没有选中任何科目！"))]),_:1},8,["visible"]),b(g,{visible:i.addDialogShow,"onUpdate:visible":s[13]||(s[13]=t=>i.addDialogShow=t),style:{width:"20rem",padding:"0.5rem","border-radius":"1rem"},header:"新增科目",modal:""},{default:p(()=>[te,e("div",se,[e("div",oe,[ne,u(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>i.addSubjectId=t),class:"h-[35px] w-[14rem] rounded-md bg-accent",style:{"text-indent":"1ch",outline:"none",border:"none","box-sizing":"border-box"},type:"text"},null,512),[[m,i.addSubjectId,void 0,{trim:!0}]])]),e("div",ie,[de,u(e("input",{"onUpdate:modelValue":s[7]||(s[7]=t=>i.addSubjectTitle=t),class:"h-[35px] w-[13rem] rounded-md bg-accent",style:{"text-indent":"1ch",outline:"none",border:"none","box-sizing":"border-box"},type:"text"},null,512),[[m,i.addSubjectTitle,void 0,{trim:!0}]])]),e("div",le,[e("div",ae,[re,u(e("select",{"onUpdate:modelValue":s[8]||(s[8]=t=>i.addSubjectType=t),class:"select outline-none h-[25px] w-[7.6rem] rounded-lg bg-accent",style:{outline:"none",border:"none","box-sizing":"border-box",height:"35px!important"}},me,512),[[w,i.addSubjectType]])]),e("div",fe,[ge,u(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>i.addSubjectSuggGrade=t),class:"select outline-none max-h-[25px] w-[7.6rem] rounded-lg bg-accent",style:{outline:"none",border:"none","box-sizing":"border-box"}},we,512),[[w,i.addSubjectSuggGrade]])])]),u(e("input",{"onUpdate:modelValue":s[10]||(s[10]=t=>i.addSubjectNote=t),class:"h-[35px] w-[15rem] rounded-lg bg-accent",maxlength:"150",placeholder:"备注(150字以内)",style:{width:"16rem","text-indent":"1ch","font-size":"0.85rem",outline:"none",border:"none","box-sizing":"border-box"},type:"text"},null,512),[[m,i.addSubjectNote,void 0,{trim:!0}]])]),e("div",Ce,[e("span",{class:"border-none btn btn-sm px-4 bg-[#f5f5f5] hover:bg-secondary",onClick:s[11]||(s[11]=t=>i.addDialogShow=!1)},"取消"),e("span",{class:"border-none btn btn-sm px-4 bg-[#f5f5f5] hover:bg-error hover:text-white",onClick:s[12]||(s[12]=(...t)=>l.addSubject&&l.addSubject(...t))},"确认新增")])]),_:1},8,["visible"])])}const Ne=D(z,[["render",De],["__scopeId","data-v-e8f370f4"]]);export{Ne as default};
